services:
  test:
    image: docker.io/toleksa/python-rest-api-test:latest
    build:
      context: .
      dockerfile: tests/integration/Dockerfile
    container_name: python-rest-api-test
    entrypoint: tail -f /dev/null
    volumes:
      - ${PWD}/tests/integration:/pytest:Z
    environment:
      - API_URL=http://api:5000
      - WWW_URL=http://www:8000
      - PROMETHEUS_URL=http://prometheus:9090
  perf:
    image: blazemeter/taurus:latest
    container_name: python-rest-api-perf
    entrypoint: ''
    command: sleep infinity
    volumes:
      - ${PWD}/tests/performance:/bzt-configs:Z
    environment:
      - API_URL=http://api:5000
  db:
    ports:
      - 3306:3306
  redis:
    ports:
      - 6379:6379
  www:
    environment:
      - ENV_API_URL=http://api:5000

 
